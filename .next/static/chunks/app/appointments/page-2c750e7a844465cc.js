(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[64],{9013:function(e,t,n){Promise.resolve().then(n.bind(n,6406))},6406:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var r=n(7437),s=n(2265),i=n(819),a=n(7138),o=n(495),l=n(1535);function c(){let[e,t]=(0,s.useState)(null),[n,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),[m,f]=(0,s.useState)(null);return((0,s.useEffect)(()=>{let e=async()=>{u(!0);let e=await (0,i.ts)();if(!e){t(null),c([]),u(!1);return}t(e);let{data:n,error:r}=await i.OQ.from("appointments").select("*").eq("user_id",e.id).order("date",{ascending:!0}).order("time",{ascending:!0});!r&&n&&c(n),u(!1)};e();let{data:n}=i.OQ.auth.onAuthStateChange(()=>{e()});return()=>{n.subscription.unsubscribe()}},[]),d)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-charcoal",children:(0,r.jsx)("div",{className:"text-softwhite/80",children:"Loading your appointments..."})}):e?(0,r.jsxs)("div",{className:"min-h-screen bg-charcoal px-4 py-16",children:[(0,r.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-softwhite mb-8",children:"My Appointments"}),0===n.length&&(0,r.jsxs)("div",{className:"bg-slate/20 border border-graphite rounded-xl p-8 text-center",children:[(0,r.jsx)("p",{className:"text-softwhite/80 mb-6",children:"You have no booked sessions yet."}),(0,r.jsx)(a.default,{href:"/booking",children:(0,r.jsx)(o.z,{className:"btn-mindspring-primary px-6 py-3",children:"Book a Session"})})]}),(0,r.jsx)("div",{className:"space-y-6",children:n.map(e=>(0,r.jsxs)("div",{className:"bg-slate/20 border border-graphite rounded-xl p-6 shadow-md",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-softwhite",children:e.session_type}),(0,r.jsx)("span",{className:"text-sm px-3 py-1 rounded-full "+("confirmed"===e.status?"bg-emerald-600/30 text-emerald-300":"cancelled"===e.status?"bg-red-600/30 text-red-300":"bg-amber-600/30 text-amber-200"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),(0,r.jsxs)("p",{className:"text-softwhite/80",children:[(0,r.jsx)("strong",{children:"Date:"})," ",e.date]}),(0,r.jsxs)("p",{className:"text-softwhite/80",children:[(0,r.jsx)("strong",{children:"Time:"})," ",e.time]}),e.notes&&(0,r.jsxs)("p",{className:"text-softwhite/70 mt-2",children:[(0,r.jsx)("strong",{children:"Notes:"})," ",e.notes]}),"cancelled"!==e.status&&(0,r.jsxs)("div",{className:"mt-4 flex gap-3",children:[(0,r.jsx)(o.z,{variant:"outline",className:"btn-mindspring-outline",onClick:async()=>{if(!confirm("Cancel this appointment?"))return;let{error:t}=await i.OQ.from("appointments").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",e.id);if(t){alert("Could not cancel appointment.");return}await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kind:"appointment_cancelled",appointment:e})}),c(t=>t.map(t=>t.id===e.id?{...t,status:"cancelled"}:t))},children:"Cancel"}),(0,r.jsx)(o.z,{className:"btn-mindspring-primary",onClick:()=>f(e),children:"Reschedule"})]})]},e.id))})]}),m&&(0,r.jsx)(l.Z,{appt:m,onClose:()=>f(null),onUpdated:e=>c(t=>t.map(t=>t.id===e.id?e:t))})]}):(0,r.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-charcoal text-center px-4",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-softwhite mb-4",children:"You are not logged in"}),(0,r.jsx)("p",{className:"text-softwhite/70 mb-6",children:"Please log in to view your booked sessions."}),(0,r.jsx)(a.default,{href:"/login",children:(0,r.jsx)(o.z,{className:"btn-mindspring-primary px-6 py-3",children:"Login"})})]})}},1535:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(7437),s=n(2265),i=n(495),a=n(819);function o(e){var t,n;let{appt:o,onClose:l,onUpdated:c}=e,[d,u]=(0,s.useState)(null!==(t=null==o?void 0:o.date)&&void 0!==t?t:""),[m,f]=(0,s.useState)(null!==(n=null==o?void 0:o.time)&&void 0!==n?n:""),[h,p]=(0,s.useState)(!1),x=async()=>{p(!0);let{data:e,error:t}=await a.OQ.from("appointments").update({date:d,time:m,updated_at:new Date().toISOString()}).eq("id",o.id).select("*").single();if(p(!1),t){alert("Could not reschedule appointment.");return}c(e),l()};return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 px-4",children:(0,r.jsxs)("div",{className:"w-full max-w-lg rounded-2xl border border-graphite bg-charcoal p-6 shadow-xl",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-softwhite mb-4",children:"Reschedule"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-softwhite/70 mb-1",children:"Date"}),(0,r.jsx)("input",{value:d,onChange:e=>u(e.target.value),className:"w-full rounded-md bg-graphite/40 border border-graphite px-3 py-2 text-softwhite",placeholder:"YYYY-MM-DD"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-softwhite/70 mb-1",children:"Time"}),(0,r.jsx)("input",{value:m,onChange:e=>f(e.target.value),className:"w-full rounded-md bg-graphite/40 border border-graphite px-3 py-2 text-softwhite",placeholder:"HH:MM"})]})]}),(0,r.jsxs)("div",{className:"mt-6 flex gap-3 justify-end",children:[(0,r.jsx)(i.z,{variant:"outline",className:"btn-mindspring-outline",onClick:l,children:"Close"}),(0,r.jsx)(i.z,{className:"btn-mindspring-primary",onClick:x,disabled:h,children:h?"Saving...":"Save"})]})]})})}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});var r=n(7437),s=n(2265),i=n(2974),a=n(3027),o=n(7440);let l=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline","mindspring-primary":"bg-primary text-primary-foreground font-semibold shadow-lg hover:bg-[color:#8B0000] transition-all duration-300","mindspring-secondary":"bg-transparent text-primary border-2 border-primary font-semibold hover:bg-primary/10 transition-all duration-300"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:n,variant:s,size:a,asChild:c=!1,...d}=e,u=c?i.g7:"button";return(0,r.jsx)(u,{className:(0,o.cn)(l({variant:s,size:a,className:n})),ref:t,...d})});c.displayName="Button"},819:function(e,t,n){"use strict";n.d(t,{OQ:function(){return r.O},c0:function(){return l},ts:function(){return o},v1:function(){return u},w7:function(){return a},wD:function(){return c},y1:function(){return s},zB:function(){return i},zQ:function(){return m}});var r=n(6881);async function s(e,t,n){let s="".concat(window.location.origin,"/auth/callback"),{data:i,error:a}=await r.O.auth.signUp({email:e,password:t,options:{data:{full_name:n},emailRedirectTo:s}});if(a)throw a;return i}async function i(e,t){let{data:n,error:s}=await r.O.auth.signInWithPassword({email:e,password:t});if(s)throw s;return n}async function a(){let{error:e}=await r.O.auth.signOut();if(e)throw e;return!0}async function o(){let{data:{user:e},error:t}=await r.O.auth.getUser();if(t)throw t;return e}async function l(e){let t="".concat(window.location.origin,"/auth/reset-password"),{data:n,error:s}=await r.O.auth.resetPasswordForEmail(e,{redirectTo:t});if(s)throw s;return n}async function c(e){let{data:t,error:n}=await r.O.from("appointments").select("*").eq("user_id",e).order("date",{ascending:!0}).order("time",{ascending:!0});if(n)throw n;return t||[]}async function d(e,t){let{data:n,error:s}=await r.O.from("appointments").update(t).eq("id",e).select().single();if(s)throw s;return n}async function u(e){return d(e,{status:"cancelled"})}async function m(e){let{data:t,error:n}=await r.O.from("program_enrolments").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return t||[]}},6881:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(7327),s=n(357);let i=s.env.NEXT_PUBLIC_SUPABASE_URL,a=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,o=(0,r.eI)(i,a)},7440:function(e,t,n){"use strict";n.d(t,{cn:function(){return i}});var r=n(4839),s=n(6164);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.m6)((0,r.W)(t))}}},function(e){e.O(0,[149,434,971,23,744],function(){return e(e.s=9013)}),_N_E=e.O()}]);