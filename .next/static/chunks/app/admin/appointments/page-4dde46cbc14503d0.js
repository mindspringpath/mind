(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[590],{1346:function(e,t,n){Promise.resolve().then(n.bind(n,7619))},7619:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var a=n(7437),r=n(2265),i=n(7138),s=n(819),l=n(495);let o=r.forwardRef(function(e,t){let{title:n,titleId:a,...i}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,r.createElement("path",{fillRule:"evenodd",d:"M12 1.5a5.25 5.25 0 0 0-5.25 5.25v3a3 3 0 0 0-3 3v6.75a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3v-6.75a3 3 0 0 0-3-3v-3c0-2.9-2.35-5.25-5.25-5.25Zm3.75 8.25v-3a3.75 3.75 0 1 0-7.5 0v3h7.5Z",clipRule:"evenodd"}))});var c=n(1535);function d(){let[e,t]=(0,r.useState)("unknown"),[n,i]=(0,r.useState)("unknown"),s=async()=>{try{let e=await fetch("/api/test-db");t(e.ok?"online":"offline")}catch(e){t("offline")}},l=async()=>{try{let e=await fetch("/api/test-email");i(e.ok?"ok":"fail")}catch(e){i("fail")}};return(0,a.jsxs)("div",{className:"bg-slate/20 border border-graphite rounded-xl p-6 mt-10",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-softwhite mb-4",children:"System Health"}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("a",{href:"https://supabase.com/dashboard/projects",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 rounded-md bg-graphite text-softwhite hover:bg-graphite/80 transition",children:[(0,a.jsx)(o,{className:"w-4 h-4"}),"Resume Supabase Project"]})}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 rounded-md bg-graphite text-softwhite hover:bg-graphite/80 transition",children:"Test Database Connection"}),(0,a.jsxs)("p",{className:"text-softwhite/60 mt-2",children:["Status: ","unknown"===e&&"Unknown","online"===e&&"\uD83D\uDFE2 Online","offline"===e&&"\uD83D\uDD34 Offline"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:l,className:"px-4 py-2 rounded-md bg-graphite text-softwhite hover:bg-graphite/80 transition",children:"Send Test Email"}),(0,a.jsxs)("p",{className:"text-softwhite/60 mt-2",children:["Status: ","unknown"===n&&"Unknown","ok"===n&&"\uD83D\uDFE2 Delivered","fail"===n&&"\uD83D\uDD34 Failed"]})]})]})}function u(){let[e,t]=(0,r.useState)(null),[n,o]=(0,r.useState)([]),[u,m]=(0,r.useState)(!0),[f,h]=(0,r.useState)("all"),[p,x]=(0,r.useState)(null);if((0,r.useEffect)(()=>{let e=async()=>{m(!0);let e=await (0,s.ts)();if(!e||"mindspringpath@gmail.com"!==e.email){t(null),m(!1);return}t(e);let{data:n,error:a}=await s.OQ.from("appointments").select("*").order("date",{ascending:!0}).order("time",{ascending:!0});!a&&n&&o(n),m(!1)};e();let{data:n}=s.OQ.auth.onAuthStateChange(()=>{e()});return()=>{n.subscription.unsubscribe()}},[]),u)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-charcoal",children:(0,a.jsx)("div",{className:"text-softwhite/80",children:"Loading admin dashboard..."})});if(!e)return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-charcoal text-center px-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-softwhite mb-4",children:"Admin Access Required"}),(0,a.jsx)("p",{className:"text-softwhite/70 mb-6",children:"You do not have permission to view this page."}),(0,a.jsx)(i.default,{href:"/login",children:(0,a.jsx)(l.z,{className:"btn-mindspring-primary px-6 py-3",children:"Login"})})]});let g="all"===f?n:n.filter(e=>e.status===f);return(0,a.jsxs)("div",{className:"min-h-screen bg-charcoal px-4 py-16",children:[(0,a.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-softwhite mb-8",children:"Admin â€” All Appointments"}),(0,a.jsx)("div",{className:"flex gap-3 mb-6",children:["all","pending","confirmed","cancelled"].map(e=>(0,a.jsx)(l.z,{variant:f===e?"default":"outline",className:f===e?"btn-mindspring-primary":"btn-mindspring-outline",onClick:()=>h(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,a.jsx)("div",{className:"space-y-6",children:g.map(e=>(0,a.jsxs)("div",{className:"bg-slate/20 border border-graphite rounded-xl p-6 shadow-md",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-softwhite",children:e.session_type}),(0,a.jsx)("span",{className:"text-sm px-3 py-1 rounded-full "+("confirmed"===e.status?"bg-emerald-600/30 text-emerald-300":"cancelled"===e.status?"bg-red-600/30 text-red-300":"bg-amber-600/30 text-amber-200"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]}),(0,a.jsxs)("p",{className:"text-softwhite/80",children:[(0,a.jsx)("strong",{children:"User:"})," ",e.full_name," (",e.email,")"]}),(0,a.jsxs)("p",{className:"text-softwhite/80",children:[(0,a.jsx)("strong",{children:"Date:"})," ",e.date]}),(0,a.jsxs)("p",{className:"text-softwhite/80",children:[(0,a.jsx)("strong",{children:"Time:"})," ",e.time]}),e.notes&&(0,a.jsxs)("p",{className:"text-softwhite/70 mt-2",children:[(0,a.jsx)("strong",{children:"Notes:"})," ",e.notes]}),(0,a.jsxs)("div",{className:"mt-4 flex gap-3",children:["confirmed"!==e.status&&"cancelled"!==e.status&&(0,a.jsx)(l.z,{className:"btn-mindspring-primary",onClick:async()=>{let{error:t}=await s.OQ.from("appointments").update({status:"confirmed",updated_at:new Date().toISOString()}).eq("id",e.id);if(t)return alert("Could not confirm appointment.");o(t=>t.map(t=>t.id===e.id?{...t,status:"confirmed"}:t))},children:"Confirm"}),"cancelled"!==e.status&&(0,a.jsx)(l.z,{variant:"outline",className:"btn-mindspring-outline",onClick:async()=>{if(!confirm("Cancel this appointment?"))return;let{error:t}=await s.OQ.from("appointments").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",e.id);if(t)return alert("Could not cancel appointment.");o(t=>t.map(t=>t.id===e.id?{...t,status:"cancelled"}:t))},children:"Cancel"}),(0,a.jsx)(l.z,{className:"btn-mindspring-primary",onClick:()=>x(e),children:"Reschedule"})]})]},e.id))}),(0,a.jsx)(d,{})]}),p&&(0,a.jsx)(c.Z,{appt:p,onClose:()=>x(null),onUpdated:e=>o(t=>t.map(t=>t.id===e.id?e:t))})]})}},1535:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(7437),r=n(2265),i=n(495),s=n(819);function l(e){var t,n;let{appt:l,onClose:o,onUpdated:c}=e,[d,u]=(0,r.useState)(null!==(t=null==l?void 0:l.date)&&void 0!==t?t:""),[m,f]=(0,r.useState)(null!==(n=null==l?void 0:l.time)&&void 0!==n?n:""),[h,p]=(0,r.useState)(!1),x=async()=>{p(!0);let{data:e,error:t}=await s.OQ.from("appointments").update({date:d,time:m,updated_at:new Date().toISOString()}).eq("id",l.id).select("*").single();if(p(!1),t){alert("Could not reschedule appointment.");return}c(e),o()};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 px-4",children:(0,a.jsxs)("div",{className:"w-full max-w-lg rounded-2xl border border-graphite bg-charcoal p-6 shadow-xl",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-softwhite mb-4",children:"Reschedule"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-softwhite/70 mb-1",children:"Date"}),(0,a.jsx)("input",{value:d,onChange:e=>u(e.target.value),className:"w-full rounded-md bg-graphite/40 border border-graphite px-3 py-2 text-softwhite",placeholder:"YYYY-MM-DD"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-softwhite/70 mb-1",children:"Time"}),(0,a.jsx)("input",{value:m,onChange:e=>f(e.target.value),className:"w-full rounded-md bg-graphite/40 border border-graphite px-3 py-2 text-softwhite",placeholder:"HH:MM"})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex gap-3 justify-end",children:[(0,a.jsx)(i.z,{variant:"outline",className:"btn-mindspring-outline",onClick:o,children:"Close"}),(0,a.jsx)(i.z,{className:"btn-mindspring-primary",onClick:x,disabled:h,children:h?"Saving...":"Save"})]})]})})}},495:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});var a=n(7437),r=n(2265),i=n(2974),s=n(3027),l=n(7440);let o=(0,s.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline","mindspring-primary":"bg-primary text-primary-foreground font-semibold shadow-lg hover:bg-[color:#8B0000] transition-all duration-300","mindspring-secondary":"bg-transparent text-primary border-2 border-primary font-semibold hover:bg-primary/10 transition-all duration-300"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:n,variant:r,size:s,asChild:c=!1,...d}=e,u=c?i.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(o({variant:r,size:s,className:n})),ref:t,...d})});c.displayName="Button"},819:function(e,t,n){"use strict";n.d(t,{OQ:function(){return a.O},c0:function(){return o},ts:function(){return l},v1:function(){return u},w7:function(){return s},wD:function(){return c},y1:function(){return r},zB:function(){return i},zQ:function(){return m}});var a=n(6881);async function r(e,t,n){let r="".concat(window.location.origin,"/auth/callback"),{data:i,error:s}=await a.O.auth.signUp({email:e,password:t,options:{data:{full_name:n},emailRedirectTo:r}});if(s)throw s;return i}async function i(e,t){let{data:n,error:r}=await a.O.auth.signInWithPassword({email:e,password:t});if(r)throw r;return n}async function s(){let{error:e}=await a.O.auth.signOut();if(e)throw e;return!0}async function l(){let{data:{user:e},error:t}=await a.O.auth.getUser();if(t)throw t;return e}async function o(e){let t="".concat(window.location.origin,"/auth/reset-password"),{data:n,error:r}=await a.O.auth.resetPasswordForEmail(e,{redirectTo:t});if(r)throw r;return n}async function c(e){let{data:t,error:n}=await a.O.from("appointments").select("*").eq("user_id",e).order("date",{ascending:!0}).order("time",{ascending:!0});if(n)throw n;return t||[]}async function d(e,t){let{data:n,error:r}=await a.O.from("appointments").update(t).eq("id",e).select().single();if(r)throw r;return n}async function u(e){return d(e,{status:"cancelled"})}async function m(e){let{data:t,error:n}=await a.O.from("program_enrolments").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return t||[]}},6881:function(e,t,n){"use strict";n.d(t,{O:function(){return l}});var a=n(7327),r=n(357);let i=r.env.NEXT_PUBLIC_SUPABASE_URL,s=r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,l=(0,a.eI)(i,s)},7440:function(e,t,n){"use strict";n.d(t,{cn:function(){return i}});var a=n(4839),r=n(6164);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[149,434,971,23,744],function(){return e(e.s=1346)}),_N_E=e.O()}]);