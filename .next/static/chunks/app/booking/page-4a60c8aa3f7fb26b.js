(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[355],{922:function(e,t,n){Promise.resolve().then(n.bind(n,7282)),Promise.resolve().then(n.bind(n,3271)),Promise.resolve().then(n.t.bind(n,231,23))},7282:function(e,t,n){"use strict";n.d(t,{default:function(){return r}});var s=n(7437),i=n(2265),a=n(819),l=n(495),o=n(6463);function r(){let e=(0,o.useRouter)(),[t,n]=(0,i.useState)(null),[r,u]=(0,i.useState)(!0),[m,c]=(0,i.useState)(!1),[d,h]=(0,i.useState)({fullName:"",email:"",phone:"",notes:"",date:"",time:"",sessionType:"Initial Consultation"});(0,i.useEffect)(()=>{let e=async()=>{try{let e=await (0,a.ts)();e&&(n(e),h(t=>{var n;return{...t,fullName:t.fullName||(null===(n=e.user_metadata)||void 0===n?void 0:n.full_name)||"",email:t.email||e.email||"",phone:t.phone||"",notes:t.notes||""}}))}catch(e){}u(!1)};e();let{data:t}=a.OQ.auth.onAuthStateChange(()=>{e()});return()=>{t.subscription.unsubscribe()}},[]);let p=e=>{let{name:t,value:n}=e.target;h(e=>({...e,[t]:n}))},b=async t=>{t.preventDefault(),c(!0);try{let t=await (0,a.ts)(),{data:n,error:s}=await a.OQ.from("appointments").select("id").eq("date",d.date).eq("time",d.time).neq("status","cancelled");if(s)throw s;if(n&&n.length>0){alert("This time slot is already booked. Please choose another time."),c(!1);return}let{data:i,error:l}=await a.OQ.from("appointments").insert({user_id:(null==t?void 0:t.id)||null,full_name:d.fullName,email:d.email,phone:d.phone,notes:d.notes,date:d.date,time:d.time,session_type:d.sessionType,status:"pending"});if(l)throw l;await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({kind:"booking_created",appointment:newAppointmentObject})}),e.push("/booking/success")}catch(e){alert("Something went wrong while booking your session.")}c(!1)};return(0,s.jsxs)("form",{onSubmit:b,className:"space-y-6 bg-charcoal p-6 rounded-xl border border-graphite",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-softwhite mb-4",children:"Book Your Session"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-softwhite/80 mb-1",children:"Full Name"}),(0,s.jsx)("input",{type:"text",name:"fullName",value:d.fullName,onChange:p,required:!0,className:"input-mindspring"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-softwhite/80 mb-1",children:"Email"}),(0,s.jsx)("input",{type:"email",name:"email",value:d.email,onChange:p,required:!0,className:"input-mindspring"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-softwhite/80 mb-1",children:"Phone"}),(0,s.jsx)("input",{type:"text",name:"phone",value:d.phone,onChange:p,className:"input-mindspring"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-softwhite/80 mb-1",children:"Date"}),(0,s.jsx)("input",{type:"date",name:"date",value:d.date,onChange:p,required:!0,className:"input-mindspring"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-softwhite/80 mb-1",children:"Time"}),(0,s.jsx)("input",{type:"time",name:"time",value:d.time,onChange:p,required:!0,className:"input-mindspring"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-softwhite/80 mb-1",children:"Session Type"}),(0,s.jsxs)("select",{name:"sessionType",value:d.sessionType,onChange:p,className:"input-mindspring",children:[(0,s.jsx)("option",{children:"Initial Consultation"}),(0,s.jsx)("option",{children:"Follow-Up Session"}),(0,s.jsx)("option",{children:"12-Week Program Session"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-softwhite/80 mb-1",children:"Notes (optional)"}),(0,s.jsx)("textarea",{name:"notes",value:d.notes,onChange:p,className:"input-mindspring h-24"})]}),(0,s.jsx)(l.z,{type:"submit",disabled:m,className:"btn-mindspring-primary w-full py-3",children:m?"Booking...":"Confirm Booking"})]})}},6463:function(e,t,n){"use strict";var s=n(1169);n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[149,434,271,971,23,744],function(){return e(e.s=922)}),_N_E=e.O()}]);